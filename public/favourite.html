<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Favourites ‚Ä¢ CHRONOMUSIOUN</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
</head>
<body>
    <header class="navbar">
        <div class="nav-left"><div class="logo">CHRONOMUSIOUN</div></div>
        <div class="nav-right">
            <nav aria-label="Primary">
                <a href="/index.html">Home</a>
                <a aria-current="page" href="/favourite.html">Favourite</a>
                <a href="/about.html">About</a>
                <a href="/gallery.html">Gallery</a>
                <a href="/download.html">Download</a>
            </nav>
            <div id="authArea"><a class="btn" href="/login.html">Login</a></div>
        </div>
    </header>

    <main>
        <div class="section-header"><h1>Your Favourites</h1><a class="btn" href="/gallery.html">Browse More</a></div>
        <div id="favGrid" class="grid"></div>
    </main>

    <a href="#top" class="back-to-top">Back To Top ^</a>
    <footer class="footer footer-grid">
        <div class="footer-brand">
            <div class="brand-row"><span class="brand-icon">üèõÔ∏è</span><span class="brand-name">CHRONOMUSIOUN</span></div>
            <p>An online museum integrating collections nationally and internationally.</p>
            <p class="small">Features: Gallery | Favourites | Search | Download</p>
        </div>
        <div class="footer-col">
            <h4>QUICK LINKS</h4>
            <a href="/index.html">HOME</a>
            <a href="/gallery.html">GALLERY</a>
        </div>
        <div class="footer-col">
            <h4>HELP</h4>
            <a href="/contact.html">SUPPORT TEAM</a>
            <a href="/contact.html">CONTACT US</a>
        </div>
        <div class="footer-col">
            <h4>ABOUT</h4>
            <a href="/privacy.html">PRIVACY & POLICY</a>
            <a href="/terms.html">TERMS & CONDITION</a>
        </div>
        <div class="footer-col">
            <h4>MAIL US:</h4>
            <a href="mailto:supportteamchrono@hotmail.com">supportteamchrono@hotmail.com</a>
            <a href="mailto:supportteammuseioun@live.in">supportteammuseioun@live.in</a>
        </div>
        <div class="footer-col">
            <h4>OFFICE ADDRESS</h4>
            <div class="address">üìç Greater noida, knowledge park III,<br>gautam budh nagar,<br>pin code 201008</div>
        </div>
        <div class="footer-sep"></div>
        <div class="footer-copy">¬© <span id="year"></span> CHRONOMUSIOUN | All rights reserved</div>
    </footer>

    <script type="module">
const els = { favGrid: document.getElementById('favGrid'), year: document.getElementById('year') };
const state = { items: [], favorites: new Set() };
els.year.textContent = new Date().getFullYear();

function loadLocalFavorites(){try{const raw=localStorage.getItem('cm_favorites'); if(raw) state.favorites=new Set(JSON.parse(raw));}catch{}}
async function api(path, options={}){ const r=await fetch(path,{credentials:'include',headers:{'Content-Type':'application/json'},...options}); if(!r.ok) throw new Error(); return r.json(); }
// include JWT if present
async function apiAuth(path, options={}){ const token=localStorage.getItem('auth_token'); const headers={'Content-Type':'application/json'}; if(token) headers['Authorization']=`Bearer ${token}`; const r=await fetch(path,{credentials:'include',headers,...options}); if(!r.ok) throw new Error(); return r.json(); }

function cardTemplate(item){return `
<div class="card" data-id="${item.id}">
  <img src="${item.imageUrl}" alt="${item.title}">
  <div class="card-body">
    <div class="card-title">${item.title}</div>
    <div class="card-meta">${item.year}</div>
    <div class="card-actions">
      <a class="icon-btn btn-download" href="/download/${item.id}" download data-title="${encodeURIComponent(item.title)}" data-year="${encodeURIComponent(item.year||'')}" data-image="${encodeURIComponent(item.imageUrl)}">‚¨á Download</a>
      <button class="icon-btn btn-remove">‚úï Remove</button>
    </div>
  </div>
</div>`}

function render(){ const favItems = state.items.filter(i=>state.favorites.has(i.id)); els.favGrid.innerHTML = favItems.map(cardTemplate).join(''); }

document.addEventListener('click',async (e)=>{
  const rem=e.target.closest('.btn-remove'); if(rem){ const card=e.target.closest('.card'); const id=Number(card.getAttribute('data-id')); state.favorites.delete(id); localStorage.setItem('cm_favorites', JSON.stringify(Array.from(state.favorites))); render(); return; }
  const dl=e.target.closest('.btn-download'); if(dl){ e.preventDefault(); const card=e.target.closest('.card'); const id=Number(card.getAttribute('data-id')); const title=decodeURIComponent(dl.getAttribute('data-title')); const year=decodeURIComponent(dl.getAttribute('data-year')); const imageUrl=decodeURIComponent(dl.getAttribute('data-image')); try{ await apiAuth('/api/downloads',{ method:'POST', body: JSON.stringify({ id, title, year, imageUrl }) }); }catch{} window.location.href = dl.getAttribute('href'); }
});

async function init(){
  loadLocalFavorites();
  try{ state.items = await api('/api/items'); render(); }catch{ els.favGrid.innerHTML='<div style="padding:20px">Failed to load favourites.</div>'; }
}
init();
// Auth state
async function renderAuth(){
  const area = document.getElementById('authArea');
  try{ const me = await fetch('/api/me',{credentials:'include'}).then(r=>r.json()); if(me && me.user){ const name=me.user.username||me.user.name||'User'; const initial=(name||'U').slice(0,1).toUpperCase(); area.innerHTML=`<div class=\"profile\"><button class=\"profile-btn\"><span class=\"avatar\">${initial}</span></button><div class=\"profile-menu\"><a href=\"/settings.html\">Update Profile</a><a href=\"/download.html\">My Downloads</a><button id=\"logoutBtn\" class=\"menu-btn\">Logout</button></div></div>`; const btn=area.querySelector('.profile-btn'); const menu=area.querySelector('.profile-menu'); btn.addEventListener('click',()=>{const o=menu.getAttribute('data-open')==='1';menu.setAttribute('data-open',o?'0':'1');}); document.addEventListener('click',(e)=>{if(!area.contains(e.target)) menu.setAttribute('data-open','0');}); area.querySelector('#logoutBtn').addEventListener('click', async ()=>{ await fetch('/api/logout',{method:'POST',credentials:'include'}); location.reload(); }); } }catch{} }
renderAuth();
    </script>

    <style>
        :root { --bg:#0a0c12; --bg-soft:#121623; --text:#f1f3f8; --muted:#a9afc3; --primary:#6b8cff; --accent:#2ee6a6; --card:#161b2a; --border:#242b3f; --space-3:16px; --space-4:20px; --radius:12px; }
        *{box-sizing:border-box} body{margin:0;font-family:'Inter',system-ui;background:linear-gradient(180deg,var(--bg) 0%,#0f1320 100%);color:var(--text)}
        .navbar{position:sticky;top:0;display:flex;justify-content:space-between;align-items:center;padding:var(--space-3) var(--space-4);background:rgba(10,12,18,0.8);backdrop-filter:blur(10px);border-bottom:1px solid var(--border)}
        .nav-left{display:flex;align-items:center;gap:var(--space-3)} .logo{font-weight:800}
        .nav-right{display:flex;align-items:center;gap:var(--space-3)} .navbar nav{display:flex;gap:var(--space-3)} .navbar nav a{color:var(--muted);text-decoration:none}
        .navbar nav a[aria-current="page"], .navbar nav a:hover{color:var(--text)}
        .btn{background:var(--card);border:1px solid var(--border);color:var(--text);padding:9px 14px;border-radius:var(--radius);text-decoration:none}
        .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px;padding:20px}
        .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;display:flex;flex-direction:column}
        .card img{width:100%;height:180px;object-fit:cover}
        .card-body{padding:16px;display:grid;gap:6px}
        .card-meta{color:var(--muted);font-size:14px}
        .icon-btn{background:transparent;border:1px solid var(--border);color:var(--text);border-radius:var(--radius);padding:8px 10px;cursor:pointer}
        .footer{border-top:1px solid var(--border);padding:var(--space-4);color:var(--muted);background:rgba(10,12,18,0.6)}
        .back-to-top{display:block;text-align:center;padding:10px;background:#bfb7b3;color:#111;font-weight:600;text-decoration:none}
        .footer-grid{display:grid;grid-template-columns:2fr 1fr 1fr 1fr 1.2fr 1.6fr;gap:20px}
        .brand-row{display:flex;gap:10px;align-items:center}.brand-name{font-weight:800}
        .footer h4{margin:0 0 10px 0;color:var(--text);font-size:14px}
        .footer a{color:var(--muted);text-decoration:none;display:block;margin:4px 0}
        .footer a:hover{color:var(--text)} .small{font-size:12px}
        .footer-sep{grid-column:1/-1;height:1px;background:var(--border)}
        .footer-copy{grid-column:1/-1}
        .profile { position: relative; }
        .profile-btn { background: var(--card); border:1px solid var(--border); color:var(--text); padding:6px 8px; border-radius: 999px; cursor:pointer; }
        .avatar { display:inline-flex; width:28px; height:28px; align-items:center; justify-content:center; background: var(--primary); color:#fff; border-radius:50%; font-weight:700 }
        .profile-menu { position:absolute; right:0; top:calc(100% + 6px); background: var(--bg-soft); border:1px solid var(--border); border-radius:10px; padding:8px; display:none; min-width:160px; z-index:60 }
        .profile-menu[data-open="1"]{ display:block }
        .profile-menu a, .profile-menu .menu-btn { display:block; width:100%; text-align:left; background:transparent; border:0; color:var(--text); text-decoration:none; padding:8px 10px; border-radius:8px; cursor:pointer }
        .profile-menu a:hover, .profile-menu .menu-btn:hover { background: var(--card); }
    </style>
</body>
</html>


